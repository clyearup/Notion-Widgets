function portion(){var e,n,i,r,c=document.getElementById("oyield").value,a=document.getElementById("dyield").value;e=fraction2Decimal(c),n=fraction2Decimal(a),e>0&&n>0&&(i=n/e,1>i&&(r=!1),i>=1&&(r=!0),convertRecipe(i,r,!0,c,a))}function multiply(){var e,n,i=document.getElementById("multiplier").value;n=fraction2Decimal(i),n>0?(e=fraction2Decimal(n),document.getElementById("oper").innerHTML="&#215;",convertRecipe(e,!0,!1,"","")):document.getElementById("oper").innerHTML=""}function divide(){var e,n,i=document.getElementById("multiplier").value;n=fraction2Decimal(i),n>0?(e=1/fraction2Decimal(n),document.getElementById("oper").innerHTML="&#247;",convertRecipe(e,!1,!1,"","")):document.getElementById("oper").innerHTML=""}function convertRecipe(e,n,i,r,c){var a,t,l,o,u,s,g=document.getElementById("recipein").value,d=document.getElementById("recipeTitle").value,m=(document.getElementById("recipeout"),""),f="",p=new Array,v=new Array,h=new Array,F=e,D=1/e,y=new Array,I=document.getElementById("fractionyes").checked,E=document.getElementById("originalyes").checked,B="********************";a=g.split("\n"),t=a.length,""!=d&&(d+="\n"),E?originalline=B+"\n-Original Recipe:\n"+B+"\n"+g+"\n"+B+"\n":originalline="",u=I?"*Recipe rounded to nearest cooking fraction\n":"",s=i?"Original size: "+r+"\nDesired size: "+c+"\n":"",m=n?d+originalline+"\n"+s+"*Original recipe multiplied by "+round2(F)+"\n"+u+"\n":d+originalline+"\n"+s+"*Original recipe divided by "+round2(D)+"\n"+u+"\n";for(var b=0;t>b;b++)if(a[b]=changefractionsymbols(a[b]),a[b]=clearbullets(a[b]),a[b]=formatOP(a[b]),a[b]=clearspace(a[b])," "==a[b].charAt(0)&&(a[b]=a[b].slice(1)),l=a[b].split(" "),o=l.length,(isFraction(l[0])||isInt(l[0])||isDecimal(l[0]))&&o>1){if(isFraction(l[0])?p[b]=fraction2Decimal(l[0]):l[0]>=0?p[b]=l[0]:p[b]="Error",isInt(l[0])&&isFraction(l[1]))if(p[b]=1*l[0]+fraction2Decimal(l[1]),o>2){v[b]=l[2];for(var A=3;o>A;A++)h[b]+=l[A]+" "}else v[b]="",h[b]="";else"_"==l[1]?v[b]=" ":v[b]=l[1],h[b]="";if(o>2){h[b]="";for(var A=2;o>A;A++){if(hasOP(l[A])){var O=getOPValue(l[A]),P=O.charAt(O.length-1);if(isFraction(O))l[A]=round2(fraction2Decimal(O)*F),I&&(l[A]=decimal2Fraction(l[A]));else if(isDecimal(O))l[A]=round2(O*F),I&&(l[A]=decimal2Fraction(l[A]));else if(isInt(O))if(o-1>A){var M=l[A+1],R=M.charAt(M.length-1);if(isFraction(M))l[A]=round2(F*O+F*fraction2Decimal(M)),I&&(l[A]=decimal2Fraction(l[A])),l[A+1]="";else if(isEndingPunc(R)){var T=M.substring(0,M.length-1);isFraction(T)?(l[A]=round2(F*O+F*fraction2Decimal(T)),I&&(l[A]=decimal2Fraction(l[A])),l[A]=l[A]+R,l[A+1]=""):(l[A]=round2(O*F),I&&(l[A]=decimal2Fraction(l[A])))}else l[A]=round2(O*F),I&&(l[A]=decimal2Fraction(l[A]))}else l[A]=round2(O*F),I&&(l[A]=decimal2Fraction(l[A]));else if(isEndingPunc(P)){var w=O.substring(0,O.length-1);isFraction(w)?(l[A]=round2(fraction2Decimal(w)*F),I&&(l[A]=decimal2Fraction(l[A])),l[A]=l[A]+P):(isDecimal(w)||isInt(w))&&(l[A]=round2(w*F),I&&(l[A]=decimal2Fraction(l[A])),l[A]=l[A]+P)}}v[b]==l[2]?A>2&&(h[b]+=l[A]+" "):h[b]+=l[A]+" ",h[b]=h[b].replace(/  /g," ")}}" "!=p[b]&&(p[b]=F*p[b]),I?y[b]=decimal2Fraction(p[b]):y[b]=round2(p[b]),f+=y[b]+" "+v[b]+" "+h[b]+"\n"}else{h[b]="";for(var A=0;o>A;A++){if(hasOP(l[A])){var O=getOPValue(l[A]),P=O.charAt(O.length-1);if(isFraction(O))l[A]=round2(fraction2Decimal(O)*F),I&&(l[A]=decimal2Fraction(l[A]));else if(isDecimal(O))l[A]=round2(O*F),I&&(l[A]=decimal2Fraction(l[A]));else if(isInt(O))if(o-1>A){var M=l[A+1],R=M.charAt(M.length-1);if(isFraction(M))l[A]=round2(F*O+F*fraction2Decimal(M)),I&&(l[A]=decimal2Fraction(l[A])),l[A+1]="";else if(isEndingPunc(R)){var T=M.substring(0,M.length-1);isFraction(T)?(l[A]=round2(F*O+F*fraction2Decimal(T)),I&&(l[A]=decimal2Fraction(l[A])),l[A]=l[A]+R,l[A+1]=""):(l[A]=round2(O*F),I&&(l[A]=decimal2Fraction(l[A])))}else l[A]=round2(O*F),I&&(l[A]=decimal2Fraction(l[A]))}else l[A]=round2(O*F),I&&(l[A]=decimal2Fraction(l[A]));else if(isEndingPunc(P)){var w=O.substring(0,O.length-1);isFraction(w)?(l[A]=round2(fraction2Decimal(w)*F),I&&(l[A]=decimal2Fraction(l[A])),l[A]=l[A]+P):(isDecimal(w)||isInt(w))&&(l[A]=round2(w*F),I&&(l[A]=decimal2Fraction(l[A])),l[A]=l[A]+P)}}h[b]+=l[A]+" ",h[b]=h[b].replace(/  /g," ")}f+=h[b]+"\n"}f=f.replace(/\/\//g,""),recipeout.value=m+f+recipeout.value}function fraction2Decimal(e){var n,i=e.indexOf(" "),r=e.indexOf("/"),c=e.substring(0,i),a=e.substring(i,r),t=e.substring(r+1),l=e.charAt(r-1),o=e.charAt(r+1),u=e.substring(i);return isFraction(u)?(-1==r||" "==l||" "==o?n=e:r>i?n=1*c+a/t:(a=e.substring(0,r),n=a/t),n):e}function decimal2Fraction(e){var n,i,r,c;return c=Math.floor(e),i=e%1,i>0&&1>i?(.1875>i&&(r="1/8"),i>=.1875&&.292>i&&(r="1/4"),i>=.292&&.417>i&&(r="1/3"),i>=.417&&.583>i&&(r="1/2"),i>=.583&&.708>i&&(r="2/3"),i>=.708&&.875>i&&(r="3/4"),i>=.875&&(r="",c+=1),n=0==c?r:0!=c&&""==r?c:c+" "+r):n=e,n}function getOPValue(e){var n=e.search("##"),i=e.substring(n+2,e.length);return i}function hasOP(e){return e.search("##")<0?!1:!0}function isEndingPunc(e){return"."==e||","==e||")"==e||"?"==e||"!"==e||"?"==e||'"'==e||"'"==e||";"==e||":"==e||"%"==e||"]"==e||"}"==e?!0:!1}function isFraction(e){var n=e.split("/");return 2==n.length&&isInt(n[0])&&isInt(n[1])&&0!=n[1]?!0:!1}function isDecimal(e){var n=e.split(".");return 2==n.length&&(isInt(n[0])||""==n[0])&&isInt(n[1])&&""!=n[1]?!0:!1}function isInt(e){if(""==e)return!1;for(var n=0;n<e.length;n++)if(!isDigit(e.charAt(n)))return!1;return!0}function isDigit(e){return e>="0"&&"9">=e?!0:!1}function clearbullets(e){var n=e;return n=n.replace(/\u2022/g,""),n=n.replace(/\u2023/g,""),n=n.replace(/\u25E6/g,""),n=n.replace(/\u2043/g,""),n=n.replace(/\u2218/g,""),n=n.replace(/\u2219/g,"")}function formatOP(e){var n=e;return n=n.replace(/##/g," ##"),n=n.replace(/## /g,"##")}function changefractionsymbols(e){var n=e;return n=n.replace(/\u00BC/g," 1/4"),n=n.replace(/\u00BD/g," 1/2"),n=n.replace(/\u00BE/g," 3/4"),n=n.replace(/\u2150/g," 1/7"),n=n.replace(/\u2151/g," 1/9"),n=n.replace(/\u2152/g," 1/10"),n=n.replace(/\u2153/g," 1/3"),n=n.replace(/\u2154/g," 2/3"),n=n.replace(/\u2155/g," 1/5"),n=n.replace(/\u2156/g," 2/5"),n=n.replace(/\u2157/g," 3/5"),n=n.replace(/\u2158/g," 4/5"),n=n.replace(/\u2159/g," 1/6"),n=n.replace(/\u215A/g," 5/6"),n=n.replace(/\u215B/g," 1/8"),n=n.replace(/\u215C/g," 3/8"),n=n.replace(/\u215D/g," 5/8"),n=n.replace(/\u215E/g," 7/8"),n=n.replace(/\u2044/g,"/"),n=n.replace(/\u2215/g,"/")}function clearspace(e){var n=e;return n=n.replace(/\s/g," "),n=n.replace(/  /g," "),n=n.replace(/  /g," ")," "==n.charAt(0)&&(n=n.slice(1))," "==n.charAt(0)&&(n=n.slice(1)),n}function round2(e){return Math.round(100*e)/100}function round3(e){return Math.round(1e3*e)/1e3}